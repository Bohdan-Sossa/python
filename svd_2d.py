import streamlit as st
import numpy as np

st.set_page_config(page_title="SVD –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ö–∞–±—à–∞-–£–º–µ—è–º–∏", layout="centered")

st.title("üî¢ SVD —Ä–æ–∑–∫–ª–∞–¥ –º–∞—Ç—Ä–∏—Ü—ñ H")
st.write("–í–≤–µ–¥—ñ—Ç—å –µ–ª–µ–º–µ–Ω—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ñ –∫–æ–≤–∞—Ä—ñ–∞—Ü—ñ—ó $H$ ($2 \\times 2$), –æ—Ç—Ä–∏–º–∞–Ω—ñ –≤ —Ç–∞–±–ª–∏—á–Ω–æ–º—É —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ.")

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—ñ—Ç–∫–∏ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
col1, col2 = st.columns(2)

with col1:
    h11 = st.number_input("H11", value=0.0, format="%.12f")
    h21 = st.number_input("H21", value=0.0, format="%.12f")

with col2:
    h12 = st.number_input("H12", value=0.0, format="%.12f")
    h22 = st.number_input("H22", value=0.0, format="%.12f")

if st.button("–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ SVD"):
    H = np.array([[h11, h12], 
                  [h21, h22]])
    
    # –í–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–æ–∑–∫–ª–∞–¥—É
    # U - –ª—ñ–≤–∞ –º–∞—Ç—Ä–∏—Ü—è, S - –≤–µ–∫—Ç–æ—Ä —Å–∏–Ω–≥—É–ª—è—Ä–Ω–∏—Ö —á–∏—Å–µ–ª, Vh - —Ç—Ä–∞–Ω—Å–ø–æ–Ω–æ–≤–∞–Ω–∞ –ø—Ä–∞–≤–∞ –º–∞—Ç—Ä–∏—Ü—è (V^T)
    U, S, Vh = np.linalg.svd(H)
    
    st.divider()
    
    # –í–∏–≤—ñ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
    st.subheader("–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑–∫–ª–∞–¥—É:")
    
    st.write("–ú–∞—Ç—Ä–∏—Ü—è U:")
    st.code(np.array2string(U, precision=12, separator=', '))
    
    st.write("–°–∏–Ω–≥—É–ª—è—Ä–Ω—ñ —á–∏—Å–ª–∞ (–¥—ñ–∞–≥–æ–Ω–∞–ª—å Œ£):")
    st.code(np.array2string(S, precision=12, separator=', '))
    
    st.write("–ú–∞—Ç—Ä–∏—Ü—è V·µÄ:")
    st.code(np.array2string(Vh, precision=12, separator=', '))
    
    # –î–æ–ø–æ–º—ñ–∂–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –¥–ª—è –ö—Ä–æ–∫—É 4 (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –¥–∑–µ—Ä–∫–∞–ª—å–Ω—ñ—Å—Ç—å)
    # R = V * U^T. –û—Å–∫—ñ–ª—å–∫–∏ linalg.svd –ø–æ–≤–µ—Ä—Ç–∞—î Vh (V^T), —Ç–æ V = Vh.T
    V = Vh.T
    det_check = np.linalg.det(V @ U.T)
    
    st.info(f"–î–ª—è –ö—Ä–æ–∫—É 5: det(V ¬∑ U·µÄ) = {det_check:.12f}")
    if det_check < 0:
        st.warning("–£–≤–∞–≥–∞: –í–∏–∑–Ω–∞—á–Ω–∏–∫ –≤—ñ–¥'—î–º–Ω–∏–π. –ù–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—Ä–∞—Ö—É–≤–∞—Ç–∏ –º–∞—Ç—Ä–∏—Ü—é d (–¥–∑–µ—Ä–∫–∞–ª—å–Ω—ñ—Å—Ç—å).")
    else:
        st.success("–í–∏–∑–Ω–∞—á–Ω–∏–∫ –¥–æ–¥–∞—Ç–Ω–∏–π. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è –±–µ–∑ –¥–∑–µ—Ä–∫–∞–ª—å–Ω–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è.")

st.sidebar.markdown("""
### –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è:
1. –°–∫–æ–ø—ñ—é–π—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è –º–∞—Ç—Ä–∏—Ü—ñ $H$ –∑ –≤–∞—à–æ–≥–æ —Ñ–∞–π–ª—É (–ö—Ä–æ–∫ 2 –ü–† ‚Ññ5).
2. –í–≤–µ–¥—ñ—Ç—å —ó—Ö —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –ø–æ–ª—è.
3. –û—Ç—Ä–∏–º–∞–Ω—ñ –º–∞—Ç—Ä–∏—Ü—ñ $U$, $\Sigma$ —Ç–∞ $V^T$ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –º–∞—Ç—Ä–∏—Ü—ñ –ø–æ–≤–æ—Ä–æ—Ç—É $R$ —Ç–∞ –∑—Å—É–≤—É $T$ –≤ —Ç–∞–±–ª–∏—á–Ω–æ–º—É —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ.
""")